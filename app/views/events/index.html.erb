<% provide(:title, 'Calendar of Appointments') %>

<div class='row-fluid'>
  <div class='span12'>
    <h1>Calendar of Appointments</h1>
  </div>
<div>

<div class='row-fluid'>
  <div class='span12'><%= render 'shared/main_navigation' %></div>
</div>
<div id='appointments' class='row-fluid'>
  <div class='span12'>
    <h2 id='month'>
      <%= link_to '<', date: @date.prev_month %>
      <%= @date.strftime('%B %Y') %>
      <%= link_to '>', date: @date.next_month %>
    </h2>
    <%= calendar @date do |date| %>
      <%= date.day %>
      <% 1.upto(4) do |slot| %>
        <ul>
          <% if appointment_filled?(@appointments_by_date[date], slot) %>
            <li>
              <% appointment = find_appointment(@appointments_by_date[date], slot) %>
              <%= link_to appointment.title, edit_appointment_path(appointment) %>
            </li>
          <% else %>
            <li>
              <%= new_appointment_link(date, slot) %>
            </li>
          <% end %>
        </ul>
      <% end %>
    <% end %>
  </div> <!-- span12 -->
</div> <!-- row-fluid appointments -->
